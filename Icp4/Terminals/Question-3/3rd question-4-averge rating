599	5
608	5
674	5
858	5
866	5
898	5
903	5
904	5
912	5
913	5
914	5
919	5
923	5
924	5
926	5
931	5
942	5
947	5
955	5
968	5
969	5
994	5
1041	5
1089	5
1103	5
1104	5
1112	5
1176	5
1179	5
1199	5
1201	5
1206	5
1208	5
1211	5
1214	5
1219	5
1221	5
1228	5
1233	5
1236	5
1244	5
1247	5
1252	5
1254	5
1260	5
1263	5
1265	5
1267	5
1278	5
1280	5
1283	5
1310	5
1344	5
1349	5
1354	5
1391	5
1394	5
1407	5
1437	5
1537	5
1573	5
1617	5
1635	5
1639	5
1673	5
1676	5
1699	5
1701	5
1719	5
1732	5
1747	5
1759	5
1809	5
1845	5
1904	5
1912	5
1916	5
1945	5
1947	5
2019	5
2028	5
2066	5
2068	5
2076	5
2159	5
2203	5
2289	5
2395	5
2488	5
2512	5
2551	5
2571	5
2599	5
2600	5
2677	5
2710	5
2731	5
2762	5
2858	5
2908	5
2912	5
2925	5
2935	5
2936	5
2972	5
2997	5
3019	5
3168	5
3201	5
3221	5
3223	5
3224	5
3265	5
3272	5
3303	5
3317	5
3341	5
3365	5
3424	5
3435	5
3473	5
3475	5
3503	5
3531	5
3535	5
3543	5
3556	5
3637	5
3655	5
3683	5
3703	5
3792	5
3996	5
4021	5
4226	5
4235	5
4419	5
4426	5
4432	5
4433	5
4789	5
6184	5
2	5
253	5
288	5
296	5
327	5
366	5
593	5
610	5
611	5
150	5
260	5
1197	5
1210	5
2572	5
2617	5
2791	5
4993	5
5952	5
6539	5
7153	5
232	5
296	5
527	5
541	5
898	5
902	5
905	5
910	5
914	5
924	5
931	5
933	5
994	5
1089	5
1211	5
1244	5
2010	5
2324	5
2360	5
2571	5
2959	5
2997	5
3000	5
3083	5
3310	5
3451	5
4356	5
7099	5
7579	5
7767	5
27815	5
44555	5
63082	5
110	5
150	5
188	5
318	5
366	5
377	5
382	5
457	5
527	5
593	5
736	5
798	5
891	5
919	5
1023	5
1036	5
1097	5
1240	5
1258	5
1259	5
1327	5
1339	5
1370	5
1407	5
1552	5
1625	5
1717	5
1917	5
1968	5
1974	5
1982	5
1997	5
2000	5
2028	5
2097	5
2194	5
2268	5
2398	5
2403	5
2529	5
2571	5
2762	5
2881	5
3020	5
3053	5
3147	5
3347	5
3363	5
3421	5
3476	5
3499	5
3755	5
296	5
858	5
1653	5
1748	5
2231	5
2490	5
2502	5
2571	5
2858	5
2959	5
3949	5
4011	5
5903	5
6365	5
6934	5
7373	5
7439	5
8810	5
8874	5
31696	5
32587	5
51662	5
53996	5
1	5
6	5
47	5
111	5
194	5
215	5
260	5
293	5
296	5
377	5
380	5
407	5
441	5
480	5
541	5
589	5
778	5
784	5
858	5
903	5
904	5
1036	5
1089	5
1136	5
1196	5
1198	5
1200	5
1201	5
1208	5
1209	5
1210	5
1213	5
1218	5
1221	5
1228	5
1240	5
1241	5
1245	5
1247	5
1258	5
1261	5
1270	5
1273	5
1274	5
1279	5
1394	5
1676	5
1682	5
1884	5
1923	5
1953	5
1967	5
2000	5
2028	5
2076	5
2288	5
2571	5
2716	5
2916	5
2924	5
2959	5
2968	5
2985	5
3114	5
3246	5
3265	5
3328	5
3362	5
3424	5
3468	5
3527	5
3578	5
3671	5
3681	5
3897	5
3925	5
3972	5
3996	5
4105	5
4226	5
4437	5
4794	5
4848	5
4878	5
4993	5
5139	5
5673	5
5772	5
5833	5
5909	5
5952	5
5954	5
6016	5
6502	5
6711	5
7022	5
7153	5
7361	5
7387	5
8142	5
8636	5
8874	5
8961	5
26169	5
26401	5
26547	5
26612	5
26681	5
27397	5
27592	5
27722	5
27773	5
30745	5
31364	5
31878	5
38061	5
38095	5
40412	5
42946	5
46578	5
47404	5
48516	5
48774	5
49272	5
50872	5
51255	5
51540	5
51709	5
52952	5
52973	5
54286	5
54503	5
55820	5
56782	5
57669	5
60333	5
61240	5
62336	5
63082	5
68157	5
70946	5
72142	5
73569	5
76091	5
76093	5
78499	5
78836	5
81834	5
86142	5
86898	5
88129	5
89745	5
92420	5
93838	5
93840	5
96610	5
96832	5
100906	5
102125	5
103341	5
106920	5
107406	5
107771	5
109968	5
110501	5
112175	5
112183	5
112290	5
115149	5
115727	5
121231	5
122882	5
122920	5
138632	5
156371	5
158238	5
164179	5
168248	5
168250	5
168252	5
Time taken: 45.233 seconds, Fetched: 13211 row(s)
hive> select M.title,avg(MR.rating) as a from movies M join ratings MR on (M.id=MR.id) where M.genre like '%Action%' group by M.title order by a desc limit 11;
Query ID = cloudera_20200617145757_640e89d9-03d7-410e-84a2-332436b8ce0c
Total jobs = 2
Execution log at: /tmp/cloudera/cloudera_20200617145757_640e89d9-03d7-410e-84a2-332436b8ce0c.log
2020-06-17 02:57:12	Starting to launch local task to process map join;	maximum memory = 932184064
2020-06-17 02:57:15	Dump the side-table for tag: 0 with group count: 1499 into file: file:/tmp/cloudera/786ed73b-9d56-410e-b601-96b95f777f97/hive_2020-06-17_14-57-03_779_5816032347933654940-1/-local-10005/HashTable-Stage-2/MapJoin-mapfile30--.hashtable
2020-06-17 02:57:15	Uploaded 1 File to: file:/tmp/cloudera/786ed73b-9d56-410e-b601-96b95f777f97/hive_2020-06-17_14-57-03_779_5816032347933654940-1/-local-10005/HashTable-Stage-2/MapJoin-mapfile30--.hashtable (73685 bytes)
2020-06-17 02:57:15	End of local task; Time Taken: 3.162 sec.
Execution completed successfully
MapredLocal task succeeded
Launching Job 1 out of 2
Number of reduce tasks not specified. Estimated from input data size: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1592420420639_0014, Tracking URL = http://quickstart.cloudera:8088/proxy/application_1592420420639_0014/
Kill Command = /usr/lib/hadoop/bin/hadoop job  -kill job_1592420420639_0014
Hadoop job information for Stage-2: number of mappers: 1; number of reducers: 1
2020-06-17 14:57:28,265 Stage-2 map = 0%,  reduce = 0%
2020-06-17 14:57:43,672 Stage-2 map = 100%,  reduce = 0%, Cumulative CPU 6.7 sec
2020-06-17 14:58:02,709 Stage-2 map = 100%,  reduce = 100%, Cumulative CPU 11.35 sec
MapReduce Total cumulative CPU time: 11 seconds 350 msec
Ended Job = job_1592420420639_0014
Launching Job 2 out of 2
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1592420420639_0015, Tracking URL = http://quickstart.cloudera:8088/proxy/application_1592420420639_0015/
Kill Command = /usr/lib/hadoop/bin/hadoop job  -kill job_1592420420639_0015
Hadoop job information for Stage-3: number of mappers: 1; number of reducers: 1
2020-06-17 14:58:21,528 Stage-3 map = 0%,  reduce = 0%
2020-06-17 14:58:39,085 Stage-3 map = 100%,  reduce = 0%, Cumulative CPU 4.82 sec
2020-06-17 14:58:55,784 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 9.48 sec
MapReduce Total cumulative CPU time: 9 seconds 480 msec
Ended Job = job_1592420420639_0015
MapReduce Jobs Launched: 
Stage-Stage-2: Map: 1  Reduce: 1   Cumulative CPU: 11.35 sec   HDFS Read: 2494623 HDFS Write: 79348 SUCCESS
Stage-Stage-3: Map: 1  Reduce: 1   Cumulative CPU: 9.48 sec   HDFS Read: 84428 HDFS Write: 457 SUCCESS
Total MapReduce CPU Time Spent: 20 seconds 830 msec
OK
Reform School Girls (1986)	5.0
Max Manus (2008)	5.0
Justice League: Doom (2012) 	5.0
Branded to Kill (Koroshi no rakuin) (1967)	5.0
Alien Contamination (1980)	5.0
Crippled Avengers (Can que) (Return of the 5 Deadly Venoms) (1981)	5.0
Supercop 2 (Project S) (Chao ji ji hua) (1993)	5.0
On the Other Side of the Tracks (De l'autre côté du périph) (2012)	5.0
Maniac Cop 2 (1990)	5.0
Sonatine (Sonachine) (1993)	5.0
Galaxy of Terror (Quest) (1981)	5.0
Time taken: 113.168 seconds, Fetched: 11 row(s)
hive> 
